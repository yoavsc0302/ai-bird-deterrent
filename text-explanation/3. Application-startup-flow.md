# Application Startup Flow

## Overview
The application follows a structured startup sequence that ensures proper initialization of all components. The process begins with `main.py`, which serves as the entry point, and progresses through configuration loading, hardware initialization, and pipeline setup.

## Startup Sequence

### 1. Entry Point (`main.py`)
The application starts in `main.py`, which serves as the orchestrator for the startup sequence. It performs three critical functions:

- **Argument Parsing**: Processes command-line arguments, primarily allowing users to specify a custom configuration file path
- **Signal Handler Setup**: Establishes handlers for graceful shutdown on SIGINT (Ctrl+C) and SIGTERM signals
- **Application Initialization**: Creates and starts the main PersonDetectionApp instance

### 2. Configuration Loading
Upon initialization of PersonDetectionApp, the first step is loading the system configuration:

- Loads settings from `config.yaml` file
- Validates all required configurations are present
- Sets up logging system based on configuration
- Creates necessary directories for logs and resources

### 3. Hardware Initialization
After configuration is loaded, the system initializes the hardware components:

- **Pan/Tilt Controller**: 
  - Initializes the servo controller for camera movement
  - Sets up I2C communication with the servo board
  - Moves servos to center position

- **Laser Controller**: 
  - Sets up GPIO control for the laser module
  - Ensures laser starts in OFF state
  - Configures pin modes and initial states

### 4. Pipeline Creation
The final initialization step is setting up the GStreamer pipeline:

- Initializes GStreamer framework
- Creates pipeline components for:
  - Video capture from Raspberry Pi camera
  - ML inference using Hailo-8L accelerator
  - Person tracking
  - Hardware control callbacks
  - Video display (if enabled)

### 5. Application Start
Once initialization is complete:

- The GStreamer pipeline starts processing video frames
- The main event loop begins
- The system is ready to detect and track people
- Hardware controllers are active and ready to respond

## Error Handling
Throughout the startup process, robust error handling ensures:

- Configuration errors are caught and reported clearly
- Hardware initialization failures are handled gracefully
- Pipeline creation issues are detected early
- Resources are properly cleaned up if startup fails

## Shutdown Process
The application includes a graceful shutdown mechanism that:

- Catches system signals (Ctrl+C, termination)
- Properly stops the GStreamer pipeline
- Cleans up hardware resources
- Centers servos and turns off laser
- Closes log files and releases system resources